<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.17">
  <compounddef id="md__r_e_a_d_m_e" kind="page">
    <compoundname>md_README</compoundname>
    <title>Research Track 2 - assignment 1</title>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
<sect3 id="md__r_e_a_d_m_e_1autotoc_md1">
<title>Marco Gabriele Fedozzi [50833565]</title>
<para><programlisting><codeline><highlight class="normal">rt2_assignment1/</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>|</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>action/<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>action<sp/>files</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>|</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Pose.action<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>goal<sp/>definition</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>cplScenes/<sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>CoppeliaSim<sp/>scenes</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>|</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>pioneer_scene.ttt<sp/><sp/><sp/><sp/><sp/>-<sp/>Pioneer<sp/>p3dx<sp/>scene</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>robotnik_scene.ttt<sp/><sp/><sp/><sp/>-<sp/>Robotnik<sp/>Summit<sp/>XL140701<sp/>scene</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>doc/<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>documentation</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>|</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>html/<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>interactive<sp/>html<sp/>description</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>|</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>...</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>latex/<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>static<sp/>latex<sp/>description</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>|</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>...</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>launch/<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>launch<sp/>files</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>|</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>sim.launch<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>Gazebo<sp/>simulation</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>sim_coppelia.launch<sp/><sp/><sp/>-<sp/>nodes<sp/>only<sp/>launch</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>scripts/<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>python<sp/>scripts</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>|</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>go_to_point.py<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>pyhton<sp/>script<sp/>controlling<sp/>the<sp/>robot</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>user_interface.py<sp/><sp/><sp/><sp/><sp/>-<sp/>minimal<sp/>command<sp/>line<sp/>UI</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>src/<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>C++<sp/>source<sp/>code</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>|</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>position_service.cpp<sp/><sp/>-<sp/>returns<sp/>random<sp/>position</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>state_machine.cpp<sp/><sp/><sp/><sp/><sp/>-<sp/>manages<sp/>the<sp/>FSM<sp/>logic</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>srv/<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>custom<sp/>services</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>!</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Command.srv<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>user<sp/>UI<sp/>input</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>RandomPosition.srv<sp/><sp/><sp/><sp/>-<sp/>bound<sp/>random<sp/>pose</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>urdf/<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>robot<sp/>description<sp/>for<sp/>Gazebo<sp/>simulation</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>|</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>my_robot.urdf<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>mobile<sp/>robot<sp/>description</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>CMakeLists.txt<sp/><sp/>-<sp/>CMake<sp/>file</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>README.md<sp/><sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>this<sp/>very<sp/>file</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/>package.xml<sp/><sp/><sp/><sp/><sp/>-<sp/>manifest</highlight></codeline>
</programlisting></para>
</sect3>
<sect1 id="md__r_e_a_d_m_e_1autotoc_md2">
<title>Package Description</title>
<para>This package controls a mobile non-holonomic robot with a simple &apos;<ref refid="namespacego__to__point" kindref="compound">go_to_point</ref>&apos; behaviour:<orderedlist>
<listitem><para>a random goal is issued (a <emphasis>pose</emphasis>, [x,y,theta]);</para>
</listitem><listitem><para>the robot orients itself towards the [x,y] destination;</para>
</listitem><listitem><para>it then drives straight to that position (adjusting the orientation if need be);</para>
</listitem><listitem><para>having reached the [x,y] goal position the robot turns in place in order to match the goal <emphasis>theta</emphasis>;</para>
</listitem><listitem><para>if the user does not stop the robot GOTO step 1, otherwise stay still until asked to start again, then GOTO step 1;</para>
</listitem></orderedlist>
</para>
<para>Since the user request is here implemented as an action it can be preempted, stoppinng the robot at any time and then restarting it when issuing a new goal.</para>
</sect1>
<sect1 id="md__r_e_a_d_m_e_1autotoc_md3">
<title>Content Explanation</title>
<para>Two nodes are implemented as python scripts<itemizedlist>
<listitem><para><bold><ref refid="go__to__point_8py" kindref="compound">go_to_point.py</ref></bold>: the action server managing the robot speed control depending on the goal received.</para>
</listitem><listitem><para><bold><ref refid="user__interface_8py" kindref="compound">user_interface.py</ref></bold>: the simple command line user interface, which sends the requests to start/stop the <ref refid="namespacego__to__point" kindref="compound">go_to_point</ref> behaviour.</para>
</listitem></itemizedlist>
</para>
<para>Whilst the last two are C++ based nodes<itemizedlist>
<listitem><para><bold><ref refid="position__service_8cpp" kindref="compound">position_service.cpp</ref></bold>: the server generating a random pose [x,y,theta] as a response to a request.</para>
</listitem><listitem><para><bold><ref refid="state__machine_8cpp" kindref="compound">state_machine.cpp</ref></bold>: the FSM managing the request of a new goal pose when needed, sending it as a goal to &apos;<ref refid="namespacego__to__point" kindref="compound">go_to_point</ref>&apos; action server.</para>
</listitem></itemizedlist>
</para>
<para><hruler/>
</para>
<para>Finally, the control can be applied to a robot simulated using Coppeliasim (see <bold>Requirements</bold>), for which two scenes are here presented<itemizedlist>
<listitem><para><bold>pioneer_scene.ttt</bold>: a simple scene with a Pioneer p3dx non-holonomic mobile robot in an empty environment.</para>
</listitem><listitem><para><bold>robotnik_scene.ttt</bold>: a simple scene with a Robotnik Summit XL140701 non-holonomic mobile robot in an empty environment.</para>
</listitem></itemizedlist>
</para>
</sect1>
<sect1 id="md__r_e_a_d_m_e_1autotoc_md5">
<title>Compiling and Running</title>
<para>Compilation can be carried out as always with <programlisting filename=".bash"><codeline><highlight class="normal">path/to/ros_ws/$<sp/>catkin_make</highlight></codeline>
</programlisting></para>
<para>Two launch files are provided:<itemizedlist>
<listitem><para><bold>sim.launch</bold>: to be used in order to launch all the nodes and the Gazebo simulation. <programlisting filename=".bash"><codeline><highlight class="normal">path/to/ros_ws/$<sp/>roslaunch<sp/>rt2_assignment1<sp/>sim.launch</highlight></codeline>
</programlisting></para>
</listitem></itemizedlist>
</para>
<para>In this case the Gazebo simulation will automatically start.</para>
<para><itemizedlist>
<listitem><para><bold>sim_coppelia.launch</bold>: to be used in order to launch all the nodes which will communicate with the Coppelia simulation. <programlisting filename=".bash"><codeline><highlight class="normal">path/to/ros_ws/$<sp/>roslaunch<sp/>rt2_assignment1<sp/>sim_coppelia.launch</highlight></codeline>
</programlisting></para>
</listitem></itemizedlist>
</para>
<para>In this case CoppeliaSim must be started separately (remember to have an instance of roscore running before launching the CoppeliaSim executable). The simulation can be either started before or after launching the nodes, but do not try to run a new simulation when the nodes have already been running on a previous one (or the system could find itself in an initial state differente from the assumed one, never being able to reach the goal).In other terms, each time the simulation is restarted the nodes should be to, and vice-versa (generally).</para>
</sect1>
<sect1 id="md__r_e_a_d_m_e_1autotoc_md6">
<title>Implementation Details</title>
<sect2 id="md__r_e_a_d_m_e_1autotoc_md7">
<title>StateMachine</title>
<para>The only choice worth of note probably regards the fact that the current robot state can be changed by either the user&apos;s input (1: start, -1: stop) or the action reaching its goal (2: action ended): in the latter case the state of the goal objective is retrieved, and a check is made on whether the action was succesful or not. If it succeeded then it starts again by defining a new random goal point, otherwise the robot will stop and wait for new user inputs.</para>
</sect2>
</sect1>
<sect1 id="md__r_e_a_d_m_e_1autotoc_md8">
<title>Documentation</title>
<para>Beside this README further documentation of all classes and methods can be found in the <bold>doc</bold> folder.</para>
</sect1>
<sect1 id="md__r_e_a_d_m_e_1autotoc_md9">
<title>Requirements</title>
<para><bold>Gazebo</bold> is required to run the first launch file (the scene definition is presented in this package). <bold>Coppeliasim</bold> is required to run the second launch file <ulink url="http://www.coppeliarobotics.com/downloads.html">download link</ulink></para>
</sect1>
<sect1 id="md__r_e_a_d_m_e_1autotoc_md10">
<title>Known Issues and Limitations</title>
<para>If you try running both the Gazebo and CoppeliaSim and the latter seems to not respond to the nodes, whilst the user interface results frozen after having told the system to run, try to <bold>kill the roscore process</bold>; this might be related to Gazebo overwriting some values related to the simulation (probably simulation time) and these not being appropriately &quot;cleaned&quot; once Gazebo is closed. </para>
</sect1>
    </detaileddescription>
  </compounddef>
</doxygen>
