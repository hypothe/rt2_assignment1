<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>rt2_assignment1(action): Research Track 2 - assignment 1</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">rt2_assignment1(action)
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Research Track 2 - assignment 1 </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h3><a class="anchor" id="autotoc_md1"></a>
Marco Gabriele Fedozzi [50833565]</h3>
<div class="fragment"><div class="line">rt2_assignment1/</div>
<div class="line">  |</div>
<div class="line">  action/         - action files</div>
<div class="line">    |</div>
<div class="line">    Pose.action           - goal definition</div>
<div class="line">  launch/         - launch files</div>
<div class="line">    |</div>
<div class="line">    sim.launch            - Gazebo simulation</div>
<div class="line">    sim_bridge.launch     - python scripts only launch</div>
<div class="line">    sim_coppelia.launch   - nodes only launch</div>
<div class="line">  scripts/        - python scripts</div>
<div class="line">    |</div>
<div class="line">    go_to_point.py        - pyhton script controlling the robot</div>
<div class="line">    user_interface.py     - minimal command line UI</div>
<div class="line">  src/            - C++ source code</div>
<div class="line">    |</div>
<div class="line">    position_service.cpp  - returns random position</div>
<div class="line">    state_machine.cpp     - manages the FSM logic</div>
<div class="line">  srv/            - custom services</div>
<div class="line">    !</div>
<div class="line">    Command.srv           - user UI input</div>
<div class="line">    RandomPosition.srv    - bound random pose</div>
<div class="line">  urdf/           - robot description for Gazebo simulation</div>
<div class="line">    |</div>
<div class="line">    my_robot.urdf         - mobile robot description</div>
<div class="line">  cplScenes/      - CoppeliaSim scenes</div>
<div class="line">    |</div>
<div class="line">    pioneer_scene.ttt     - Pioneer p3dx scene</div>
<div class="line">    robotnik_scene.ttt    - Robotnik Summit XL140701 scene</div>
<div class="line">  CMakeLists.txt  - CMake file</div>
<div class="line">  README.md       - this very file</div>
<div class="line">  package.xml     - manifest</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md2"></a>
Package Description</h1>
<p>This package controls a mobile non-holonomic robot with a simple '<a class="el" href="namespacego__to__point.html">go_to_point</a>' behaviour:</p><ol type="1">
<li>a random goal is issued (a <em>pose</em>, [x,y,theta]);</li>
<li>the robot orients itself towards the [x,y] destination;</li>
<li>it then drives straight to that position (adjusting the orientation if need be);</li>
<li>having reached the [x,y] goal position the robot turns in place in order to match the goal <em>theta</em>;</li>
<li>if the user does not stop the robot GOTO step 1, otherwise stay still until asked to start again, then GOTO step 1;</li>
</ol>
<p>Since the user request is here implemented as an action it can be preempted, stoppinng the robot at any time and then restarting it when issuing a new goal.</p>
<h1><a class="anchor" id="autotoc_md3"></a>
Content Explanation</h1>
<p>Two nodes are implemented as python scripts</p><ul>
<li><b><a class="el" href="go__to__point_8py.html">go_to_point.py</a></b>: the action server managing the robot speed control depending on the goal received.</li>
<li><b><a class="el" href="user__interface_8py.html">user_interface.py</a></b>: the simple command line user interface, which sends the requests to start/stop the <a class="el" href="namespacego__to__point.html">go_to_point</a> behaviour.</li>
</ul>
<p>Whilst the last two are C++ based nodes</p><ul>
<li><b><a class="el" href="position__service_8cpp.html">position_service.cpp</a></b>: the server generating a random pose [x,y,theta] as a response to a request.</li>
<li><b><a class="el" href="state__machine_8cpp.html">state_machine.cpp</a></b>: the FSM managing the request of a new goal pose when needed, sending it as a goal to '<a class="el" href="namespacego__to__point.html">go_to_point</a>' action server.</li>
</ul>
<hr  />
<p>Finally, the control can be applied to a robot simulated using Coppeliasim (see <b>Requirements</b>), for which two scenes are here presented</p><ul>
<li><b>pioneer_scene.ttt</b>: a simple scene with a Pioneer p3dx non-holonomic mobile robot in an empty environment.</li>
<li><b>robotnik_scene.ttt</b>: a simple scene with a Robotnik Summit XL140701 non-holonomic mobile robot in an empty environment.</li>
</ul>
<h1><a class="anchor" id="autotoc_md5"></a>
Compiling and Running</h1>
<p>Compilation can be carried out as always with </p><div class="fragment"><div class="line">path/to/ros_ws/$ catkin_make</div>
</div><!-- fragment --><p>Two launch files are provided:</p><ul>
<li><b>sim.launch</b>: to be used in order to launch all the nodes and the Gazebo simulation. <div class="fragment"><div class="line">path/to/ros_ws/$ roslaunch rt2_assignment1 sim.launch</div>
</div><!-- fragment --></li>
</ul>
<p>In this case the Gazebo simulation will automatically start.</p>
<ul>
<li><b>sim_coppelia.launch</b>: to be used in order to launch all the nodes which will communicate with the Coppelia simulation. <div class="fragment"><div class="line">path/to/ros_ws/$ roslaunch rt2_assignment1 sim_coppelia.launch</div>
</div><!-- fragment --></li>
</ul>
<p>In this case CoppeliaSim must be started separately (remember to have an instance of roscore running before launching the CoppeliaSim executable). The simulation can be either started before or after launching the nodes, but do not try to run a new simulation when the nodes have already been running on a previous one (or the system could find itself in an initial state differente from the assumed one, never being able to reach the goal).In other terms, each time the simulation is restarted the nodes should be to, and vice-versa (generally).</p>
<h1><a class="anchor" id="autotoc_md6"></a>
Implementation Details</h1>
<h2><a class="anchor" id="autotoc_md7"></a>
StateMachine</h2>
<p>The only choice worth of note probably regards the fact that the current robot state can be changed by either the user's input (1: start, -1: stop) or the action reaching its goal (2: action ended): in the latter case the state of the goal objective is retrieved, and a check is made on whether the action was succesful or not. If it succeeded then it starts again by defining a new random goal point, otherwise the robot will stop and wait for new user inputs.</p>
<h1><a class="anchor" id="autotoc_md8"></a>
Documentation</h1>
<p>Beside this README further documentation of all classes and methods can be found in the <b>doc</b> folder.</p>
<h1><a class="anchor" id="autotoc_md9"></a>
Requirements</h1>
<p><b>Gazebo</b> is required to run the first launch file (the scene definition is presented in this package). <b>Coppeliasim</b> is required to run the second launch file <a href="http://www.coppeliarobotics.com/downloads.html">download link</a></p>
<h1><a class="anchor" id="autotoc_md10"></a>
Known Issues and Limitations</h1>
<p>If you try running both the Gazebo and CoppeliaSim and the latter seems to not respond to the nodes, whilst the user interface results frozen after having told the system to run, try to <b>kill the roscore process</b>; this might be related to Gazebo overwriting some values related to the simulation (probably simulation time) and these not being appropriately "cleaned" once Gazebo is closed. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
